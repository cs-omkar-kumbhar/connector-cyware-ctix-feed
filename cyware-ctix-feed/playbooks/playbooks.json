{
  "type": "workflow_collections",
  "data": [
    {
      "@type": "WorkflowCollection",
      "name": "Sample - Cyware CTIX Feed - 1.1.0",
      "description": "Sample playbooks for \"Cyware CTIX Feed\" connector. If you are planning to use any of the sample playbooks in your environment, ensure that you clone those playbooks and move them to a different collection, since the sample playbook collection gets deleted during connector upgrade and delete.",
      "visible": true,
      "image": null,
      "uuid": "0c20cc35-7c0c-48c9-83bb-74fe2bda5c9a",
      "id": 47,
      "deletedAt": null,
      "importedBy": [],
      "recordTags": [
        "Cyware",
        "cyware-ctix-feed"
      ],
      "workflows": [
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Cyware CTIX Feed > Ingest",
          "aliasName": null,
          "tag": null,
          "description": "Fetch Indicators from Cyware CTIX Feed.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1712222316,
          "collection": "/api/3/workflow_collections/0c20cc35-7c0c-48c9-83bb-74fe2bda5c9a",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/4e5f0b5d-9b37-46e7-b567-4140ed024cd1",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Fetch Indicators",
              "description": null,
              "arguments": {
                "arguments": [],
                "apply_async": false,
                "step_variables": [],
                "pass_parent_env": false,
                "pass_input_record": false,
                "workflowReference": "/api/3/workflows/f2311268-b3f1-449a-a62d-a661175b5477"
              },
              "status": null,
              "top": "140",
              "left": "200",
              "stepType": "/api/3/workflow_step_types/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
              "group": null,
              "uuid": "7d97c70f-04ce-4250-a32f-418e55abed74"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "step_variables": {
                  "input": {
                    "params": []
                  }
                }
              },
              "status": null,
              "top": "40",
              "left": "40",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "group": null,
              "uuid": "4e5f0b5d-9b37-46e7-b567-4140ed024cd1"
            },
            {
              "@type": "WorkflowStep",
              "name": "Update Pull Time",
              "description": null,
              "arguments": {
                "params": {
                  "macro": "{{vars.steps.Fetch_Indicators.macro_name}}",
                  "value": "{{vars.steps.Fetch_Indicators.updated_last_pull_time}}"
                },
                "version": "3.2.3",
                "connector": "cyops_utilities",
                "operation": "updatemacro",
                "operationTitle": "FSR: Create/Update Global Variables",
                "step_variables": []
              },
              "status": null,
              "top": "240",
              "left": "360",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "group": null,
              "uuid": "4a54beb4-f68a-401e-84e0-bbc8f0fb672e"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Fetch Indicators -> Update Pull Time",
              "targetStep": "/api/3/workflow_steps/4a54beb4-f68a-401e-84e0-bbc8f0fb672e",
              "sourceStep": "/api/3/workflow_steps/7d97c70f-04ce-4250-a32f-418e55abed74",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "a4526cb4-7cf1-4324-9bc1-597e2a3c324f"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Fetch Indicators",
              "targetStep": "/api/3/workflow_steps/7d97c70f-04ce-4250-a32f-418e55abed74",
              "sourceStep": "/api/3/workflow_steps/4e5f0b5d-9b37-46e7-b567-4140ed024cd1",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "763d3f8a-d983-4329-ab7f-805512f3daf5"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "29dea804-b9ed-46b3-b550-46ec058c2b5d",
          "id": 576,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Cyware",
            "cyware-ctix-feed",
            "dataingestion",
            "ingest"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Save Result Set Data",
          "aliasName": null,
          "tag": "#Cyware CTIX Feed",
          "description": "Retrieves the detailed list of Save Result Set data for CTIX 3.0 version. All the SDOs are available over the save result set V3 API.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": null,
          "collection": "/api/3/workflow_collections/0c20cc35-7c0c-48c9-83bb-74fe2bda5c9a",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/9d0d976f-3bf7-4b90-a4e1-9dac52a15c9a",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get Save Result Set Data",
              "description": null,
              "arguments": {
                "name": "Cyware CTIX Feed",
                "config": "''",
                "params": {
                  "page": 1,
                  "page_size": 100,
                  "label_name": "",
                  "to_timestamp": "",
                  "from_timestamp": ""
                },
                "version": "1.1.0",
                "connector": "cyware-ctix-feed",
                "operation": "get_save_result_set_data",
                "operationTitle": "Get Save Result Set Data",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "188",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "2770d721-3bc2-44cb-ab1f-41b20c1c1db5"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "step_variables": {
                  "input": {
                    "params": []
                  }
                }
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "group": null,
              "uuid": "9d0d976f-3bf7-4b90-a4e1-9dac52a15c9a"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start-> Get Save Result Set Data",
              "targetStep": "/api/3/workflow_steps/2770d721-3bc2-44cb-ab1f-41b20c1c1db5",
              "sourceStep": "/api/3/workflow_steps/9d0d976f-3bf7-4b90-a4e1-9dac52a15c9a",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "7c2d8c32-4a37-4780-a491-0b51c95f6de0"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "8b78bf4b-feca-4ddb-919a-81f735d06d87",
          "id": 511,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Cyware",
            "cyware-ctix-feed"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Save Result Set Indicators",
          "aliasName": null,
          "tag": "#Cyware CTIX Feed",
          "description": "Retrieves the detailed list of Save Result Set Indicators for CTIX 3.0 version. All the Indicator SDOs are available over the save result set V3 API.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1684757625,
          "collection": "/api/3/workflow_collections/0c20cc35-7c0c-48c9-83bb-74fe2bda5c9a",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/da178c82-d1bc-4e2a-82f6-da6c885422a1",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get Save Result Set Indicators",
              "description": null,
              "arguments": {
                "name": "Cyware CTIX Feed",
                "config": "''",
                "params": {
                  "label_name": "",
                  "to_timestamp": "",
                  "record_number": "Fetch Limited Records",
                  "from_timestamp": ""
                },
                "version": "1.1.0",
                "connector": "cyware-ctix-feed",
                "operation": "get_save_result_set_indicators",
                "operationTitle": "Get Save Result Set Indicators",
                "step_variables": {
                  "output_data": "{{vars.result}}"
                }
              },
              "status": null,
              "top": "120",
              "left": "188",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "bf10ca77-0031-4b6b-ad02-a55c5441f50b"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "step_variables": {
                  "input": {
                    "params": []
                  }
                }
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "group": null,
              "uuid": "da178c82-d1bc-4e2a-82f6-da6c885422a1"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start-> Get Save Result Set Indicators",
              "targetStep": "/api/3/workflow_steps/bf10ca77-0031-4b6b-ad02-a55c5441f50b",
              "sourceStep": "/api/3/workflow_steps/da178c82-d1bc-4e2a-82f6-da6c885422a1",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "25ac95ab-8aee-450f-9260-565ee4462571"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "d6dbb757-1e11-4ebb-a224-2aa6e76abb5b",
          "id": 513,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Cyware",
            "cyware-ctix-feed"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "Get Threat Data",
          "aliasName": null,
          "tag": "#Cyware CTIX Feed",
          "description": "Retrieves the detailed list of threat data objects from the CTIX application. You can retrieve a maximum of 5,00,000 threat data objects using this API.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1712137068,
          "collection": "/api/3/workflow_collections/0c20cc35-7c0c-48c9-83bb-74fe2bda5c9a",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/b7911f9f-156e-4a86-9f48-75f7f26cbca4",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Get Threat Data",
              "description": null,
              "arguments": {
                "name": "Cyware CTIX Feed",
                "config": "eaea35e6-42e4-4f36-b9c6-2aaddcf74575",
                "params": {
                  "page": 1,
                  "sort": "",
                  "query": "type=\"indicator\"",
                  "page_size": 100,
                  "enrichment": "",
                  "page_limit": "",
                  "fetch_all_records": ""
                },
                "version": "1.1.0",
                "connector": "cyware-ctix-feed",
                "operation": "get_threat_data",
                "operationTitle": "Get Threat Data",
                "step_variables": []
              },
              "status": null,
              "top": "120",
              "left": "188",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "99e7b3c6-588b-4e13-b78b-b85f0792045b"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "step_variables": {
                  "input": {
                    "params": []
                  }
                }
              },
              "status": null,
              "top": "20",
              "left": "20",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "group": null,
              "uuid": "b7911f9f-156e-4a86-9f48-75f7f26cbca4"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Start-> Get Threat Data",
              "targetStep": "/api/3/workflow_steps/99e7b3c6-588b-4e13-b78b-b85f0792045b",
              "sourceStep": "/api/3/workflow_steps/b7911f9f-156e-4a86-9f48-75f7f26cbca4",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "af69cb6a-4a5e-4543-b443-dd383176241d"
            }
          ],
          "groups": [],
          "priority": null,
          "uuid": "e5fec8e4-85d8-4167-9928-51a8f87bdbe4",
          "id": 514,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "Cyware",
            "cyware-ctix-feed"
          ]
        },
        {
          "@type": "Workflow",
          "triggerLimit": null,
          "name": "> Cyware CTIX Feed > Fetch and Create",
          "aliasName": null,
          "tag": null,
          "description": "Fetch and Create Indicators from Cyware CTIX Feed.",
          "isActive": false,
          "debug": false,
          "singleRecordExecution": false,
          "remoteExecutableFlag": false,
          "parameters": [],
          "synchronous": false,
          "lastModifyDate": 1712222316,
          "collection": "/api/3/workflow_collections/0c20cc35-7c0c-48c9-83bb-74fe2bda5c9a",
          "versions": [],
          "triggerStep": "/api/3/workflow_steps/5f28cfd0-c7c1-4e78-91af-1560c60df4fb",
          "steps": [
            {
              "@type": "WorkflowStep",
              "name": "Configuration",
              "description": null,
              "arguments": {
                "page": 1,
                "sort": "-ctix_created",
                "query": "",
                "tlp_map": "{'RED': {{'TrafficLightProtocol'| picklist('Red') }}, 'AMBER': {{'TrafficLightProtocol'| picklist('Amber') }}, 'GREEN': {{'TrafficLightProtocol'| picklist('Green') }}, 'WHITE': {{'TrafficLightProtocol'| picklist('White') }}}",
                "page_size": 20,
                "enrichment": false,
                "reputation": "Malicious",
                "output_mode": "Return as a JSON",
                "pullTimeMacro": "CywareCTIXFeedPullTime_{{vars['audit_info']['cyops_playbook_iri'].split('/')[-1].replace('-','_')}}",
                "record_number": "Fetch Limited Records",
                "reputation_map": "{'Good': {{'IndicatorReputation'| picklist('Good') }}, 'Malicious': {{'IndicatorReputation'| picklist('Malicious') }}, 'Suspicious': {{'IndicatorReputation'| picklist('Suspicious') }}, 'TBD': {{'IndicatorReputation'| picklist('TBD') }}, 'No Reputation Available': {{'IndicatorReputation' | picklist('No Reputation Available') }}}",
                "currentPullTime": "{{arrow.utcnow().int_timestamp}}",
                "indicator_type_map": "{\n    'domain-name': {{'ThreatIntelFeedType' | picklist('Domain')}},\n     'email-addr': {{'ThreatIntelFeedType' | picklist('Email Address')}},\n    'file-md5': {{'ThreatIntelFeedType' | picklist('FileHash-MD5')}},\n    'file-sha1': {{'ThreatIntelFeedType' | picklist('FileHash-SHA1')}},\n    'file-sha256': {{'ThreatIntelFeedType' | picklist('FileHash-SHA256')}},\n    'ipv4-addr': {{'ThreatIntelFeedType' | picklist('IPv4 Address')}},\n    'ipv6-addr': {{'ThreatIntelFeedType' | picklist('IPv6 Address')}},\n    'process': {{'ThreatIntelFeedType' | picklist('Process')}},\n    'url': {{'ThreatIntelFeedType' | picklist('URL')}},\n}",
                "threat_intel_feeds_tLP_map": "{}",
                "fetch_data_in_last_X_minutes": "60",
                "threat_intel_feeds_reputation_map": "{}",
                "threat_intel_feeds_typeOfFeed_map": "{}"
              },
              "status": null,
              "top": "140",
              "left": "40",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "ae4e9e41-33be-402f-a263-76df47ac43d4"
            },
            {
              "@type": "WorkflowStep",
              "name": "Create Feed List",
              "description": null,
              "arguments": {
                "fetched_data": "{{vars.steps.Fetch_Indicators.data or vars.steps.Fetch_Indicators_Limited.data}}"
              },
              "status": null,
              "top": "660",
              "left": "820",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "af3335d3-da17-47ea-ba46-be4437bc4bb2"
            },
            {
              "@type": "WorkflowStep",
              "name": "Create Record",
              "description": null,
              "arguments": {
                "when": "{{vars.fetched_data.results | length > 0}}",
                "for_each": {
                  "item": "{{vars.fetched_data.results}}",
                  "__bulk": false,
                  "parallel": false,
                  "condition": ""
                },
                "resource": {
                  "tLP": "{% if vars.item.tlp %}{{ vars.item.tlp.upper() | resolveRange(vars.tlp_map) }}{% else %}{{ None }}{% endif %}",
                  "value": "{{vars.item.name}}",
                  "source": "Cyware CTIX Feed",
                  "created": "{% if vars.item.ctix_created %}{{ vars.item.ctix_created | int }}{% endif %}",
                  "modified": "{% if vars.item.ctix_modified %}{{ vars.item.ctix_modified | int }}{% endif %}",
                  "sourceId": "{{vars.item.id}}",
                  "__replace": "true",
                  "validFrom": "{% if vars.item.valid_from %}{{ vars.item.valid_from | int }}{% endif %}",
                  "confidence": "{% if vars.item.confidence_score %}{{ vars.item.confidence_score | int }}{% else %}{{ None }}{% endif %}",
                  "reputation": "{{vars.reputation_resolved}}",
                  "sourceData": "{{vars.item | toJSON}}",
                  "typeOfFeed": "{% if vars.item.ioc_type %}{{ vars.item.ioc_type.lower() | resolveRange(vars.indicator_type_map)}}{% else %}{{ None }}{% endif %}",
                  "validUntil": "{% if vars.item.valid_until %}{{ vars.item.valid_until | int }}{% endif %}"
                },
                "operation": "Overwrite",
                "collection": "/api/3/upsert/threat_intel_feeds",
                "__recommend": [],
                "fieldOperation": {
                  "recordTags": "Overwrite",
                  "threatTypes": "Overwrite",
                  "killChainPhases": "Overwrite"
                },
                "step_variables": []
              },
              "status": null,
              "top": "760",
              "left": "980",
              "stepType": "/api/3/workflow_step_types/2597053c-e718-44b4-8394-4d40fe26d357",
              "group": null,
              "uuid": "5e57c359-8b3d-4afd-959d-d1d8e35949d7"
            },
            {
              "@type": "WorkflowStep",
              "name": "Fetch Indicators",
              "description": null,
              "arguments": {
                "name": "Cyware CTIX Feed",
                "config": "eaea35e6-42e4-4f36-b9c6-2aaddcf74575",
                "params": {
                  "page": "",
                  "sort": "{{vars.sort}}",
                  "query": "{{vars.query}}",
                  "page_size": "",
                  "enrichment": "{{vars.enrichment}}",
                  "page_limit": "",
                  "fetch_all_records": true
                },
                "version": "1.1.0",
                "connector": "cyware-ctix-feed",
                "operation": "get_threat_data",
                "operationTitle": "Get Threat Data",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "660",
              "left": "420",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "6610fe3c-4053-424b-82a6-18165de6d572"
            },
            {
              "@type": "WorkflowStep",
              "name": "Fetch Indicators Limited",
              "description": null,
              "arguments": {
                "name": "Cyware CTIX Feed",
                "config": "eaea35e6-42e4-4f36-b9c6-2aaddcf74575",
                "params": {
                  "page": "{{vars.page}}",
                  "sort": "{{vars.sort}}",
                  "query": "{{vars.query}}",
                  "page_size": "{{vars.page_size}}",
                  "enrichment": "{{vars.enrichment}}",
                  "page_limit": "",
                  "fetch_all_records": false
                },
                "version": "1.1.0",
                "connector": "cyware-ctix-feed",
                "operation": "get_threat_data",
                "operationTitle": "Get Threat Data",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "540",
              "left": "820",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "e7941217-07de-4066-8889-f795e2ba6d82"
            },
            {
              "@type": "WorkflowStep",
              "name": "Fetch Sample Indicators",
              "description": null,
              "arguments": {
                "name": "Cyware CTIX Feed",
                "config": "eaea35e6-42e4-4f36-b9c6-2aaddcf74575",
                "params": {
                  "page": 1,
                  "sort": "",
                  "query": "type=\"indicator\"",
                  "page_size": 5,
                  "enrichment": "",
                  "page_limit": "",
                  "fetch_all_records": ""
                },
                "version": "1.1.0",
                "connector": "cyware-ctix-feed",
                "operation": "get_threat_data",
                "operationTitle": "Get Threat Data",
                "pickFromTenant": false,
                "step_variables": []
              },
              "status": null,
              "top": "660",
              "left": "40",
              "stepType": "/api/3/workflow_step_types/0bfed618-0316-11e7-93ae-92361f002671",
              "group": null,
              "uuid": "0f516390-3ec6-470d-8ac0-8eb87e92908a"
            },
            {
              "@type": "WorkflowStep",
              "name": "Get Macro Value",
              "description": null,
              "arguments": {
                "params": {
                  "iri": "/api/wf/api/dynamic-variable/?name={{vars.pullTimeMacro}}",
                  "body": "",
                  "method": "GET"
                },
                "version": "3.2.3",
                "connector": "cyops_utilities",
                "operation": "make_cyops_request",
                "operationTitle": "FSR: Make FortiSOAR API Call",
                "step_variables": []
              },
              "status": null,
              "top": "240",
              "left": "40",
              "stepType": "/api/3/workflow_step_types/0109f35d-090b-4a2b-bd8a-94cbc3508562",
              "group": null,
              "uuid": "64485e00-9584-4ac1-a526-d2d210bc461b"
            },
            {
              "@type": "WorkflowStep",
              "name": "Is data only for mapping",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "Yes, For Mapping",
                    "step_iri": "/api/3/workflow_steps/0f516390-3ec6-470d-8ac0-8eb87e92908a",
                    "condition": "{{ vars.request.env_setup == true }}",
                    "step_name": "Fetch Sample Indicators"
                  },
                  {
                    "option": "No, For Ingestion",
                    "default": true,
                    "step_iri": "/api/3/workflow_steps/0423c84d-3ef2-4ba7-bb11-ec376117de20",
                    "step_name": "Number of Records to Fetch"
                  }
                ]
              },
              "status": null,
              "top": "540",
              "left": "40",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "group": null,
              "uuid": "e80a51bd-ee90-4cd1-a228-f25dfe23d173"
            },
            {
              "@type": "WorkflowStep",
              "name": "Make Query",
              "description": null,
              "arguments": {
                "query": "{% if vars.query %}{{vars.query}} AND type=\"indicator\" AND ctix_created RANGE (\"{{vars.last_pull_time}}\",\"{{vars.currentPullTime}}\"){% else %}type=\"indicator\" AND ctix_created RANGE (\"{{vars.last_pull_time}}\",\"{{vars.currentPullTime}}\"){%endif%}"
              },
              "status": null,
              "top": "440",
              "left": "40",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "94858ce4-6446-40a5-b706-f13ad3e068f5"
            },
            {
              "@type": "WorkflowStep",
              "name": "Number of Records to Fetch",
              "description": null,
              "arguments": {
                "conditions": [
                  {
                    "option": "Fetch Limited Records",
                    "step_iri": "/api/3/workflow_steps/e7941217-07de-4066-8889-f795e2ba6d82",
                    "condition": "{{ vars.record_number == \"Fetch Limited Records\" }}",
                    "step_name": "Fetch Indicators Limited"
                  },
                  {
                    "option": "Fetch All Records",
                    "default": true,
                    "step_iri": "/api/3/workflow_steps/6610fe3c-4053-424b-82a6-18165de6d572",
                    "step_name": "Fetch Indicators"
                  }
                ]
              },
              "status": null,
              "top": "540",
              "left": "420",
              "stepType": "/api/3/workflow_step_types/12254cf5-5db7-4b1a-8cb1-3af081924b28",
              "group": null,
              "uuid": "0423c84d-3ef2-4ba7-bb11-ec376117de20"
            },
            {
              "@type": "WorkflowStep",
              "name": "Resolve Range",
              "description": null,
              "arguments": {
                "last_pull_time": "{% if (vars.steps.Get_Macro_Value.data[\"hydra:member\"] | length) > 0%}{{vars.steps.Get_Macro_Value.data[\"hydra:member\"][0].value }}{% else %}{{arrow.utcnow().shift(minutes=-vars.fetch_data_in_last_X_minutes).int_timestamp}}{% endif %}",
                "reputation_resolved": "{{vars.reputation | resolveRange(vars.reputation_map)}}"
              },
              "status": null,
              "top": "340",
              "left": "40",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "33d4aa0e-aef1-43f9-bb9f-4f691e04c19f"
            },
            {
              "@type": "WorkflowStep",
              "name": "Return Sample Data",
              "description": null,
              "arguments": {
                "data": "{{vars.steps.Fetch_Sample_Indicators.data.results[0:10]}}"
              },
              "status": null,
              "top": "760",
              "left": "40",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "af331221-8d2b-4278-9708-ea72b9707f56"
            },
            {
              "@type": "WorkflowStep",
              "name": "Save Result",
              "description": null,
              "arguments": {
                "macro_name": "{{vars.pullTimeMacro}}",
                "updated_last_pull_time": "{{vars.currentPullTime}}"
              },
              "status": null,
              "top": "860",
              "left": "1140",
              "stepType": "/api/3/workflow_step_types/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
              "group": null,
              "uuid": "3182873d-b317-48b1-bf4c-5faca1f0b94c"
            },
            {
              "@type": "WorkflowStep",
              "name": "Start",
              "description": null,
              "arguments": {
                "__triggerLimit": true,
                "step_variables": {
                  "input": {
                    "params": []
                  },
                  "_configuration_schema": "[\n  {\n    \"title\":\"Pull Sample Indicators in Past X Minutes\",\n    \"name\":\"fetch_data_in_last_X_minutes\",\n    \"type\":\"text\",\n    \"tooltip\":\"Pull the incidents in the past X minutes. e.g. 14400 minutes are 10 days.\",\n    \"required\":true,\n    \"editable\":true,\n    \"visible\":true\n  },\n  {\n    \"title\":\"CQL Query\",\n    \"name\":\"query\",\n    \"type\":\"text\",\n    \"tooltip\":\"Specify the CQL query to filter and fetch results. Note: type = \\\"indicator\\\" and time range filter is provided internally.\",\n    \"required\":false,\n    \"editable\":true,\n    \"visible\":true\n  },\n  {\n    \"title\":\"Enrichment\",\n    \"name\":\"enrichment\",\n    \"type\":\"checkbox\",\n    \"tooltip\":\"Select the checkbox to retrieve the details of the last enrichment for the objects that can be enriched.\",\n    \"required\":false,\n    \"editable\":true,\n    \"visible\":true\n  },\n  {\n    \"title\":\"Sort\",\n    \"name\":\"sort\",\n    \"type\":\"text\",\n    \"tooltip\":\"Specify the field by which you want to sort the records. By default it will be sorted in ascending and by adding '-' prefix it will sorted in descending order. eg: -ctix_created\",\n    \"required\":false,\n    \"editable\":true,\n    \"visible\":true\n  },\n  {\n    \"title\":\"Reputation\",\n    \"name\":\"reputation\",\n    \"type\":\"select\",\n    \"tooltip\":\"Default Reputation to be set for the feeds\",\n    \"required\":true,\n    \"editable\":true,\n    \"visible\":true,\n    \"options\":[\n      \"Good\",\n      \"Suspicious\",\n      \"Malicious\",\n      \"No Reputation Available\",\n      \"TBD\"\n    ],\n    \"value\":\"TBD\"\n  },\n  {\n  \"title\": \"Number of Records to Return\",\n  \"name\": \"record_number\",\n  \"type\": \"select\",\n  \"visible\": true,\n  \"editable\": true,\n  \"required\": true,\n  \"options\": [\n    \"Fetch All Records\",\n    \"Fetch Limited Records\"\n  ],\n  \"onchange\": {\n    \"Fetch All Records\": [],\n    \"Fetch Limited Records\": [\n      {\n        \"title\": \"Page Number\",\n        \"required\": true,\n        \"editable\": true,\n        \"visible\": true,\n        \"type\": \"integer\",\n        \"name\": \"page\",\n        \"value\": 1,\n        \"tooltip\": \"Specify the page number from which to retrieve the records. The default value is 1.\"\n      },\n      {\n        \"title\": \"Page Size\",\n        \"required\": true,\n        \"editable\": true,\n        \"visible\": true,\n        \"type\": \"integer\",\n        \"name\": \"page_size\",\n        \"value\": 10,\n        \"tooltip\": \"Specify the count of records that the operation should include per page.\"\n      }\n    ]\n  }\n}\n]",
                  "DragosLastAlertPullTime": "DragosAlertPullTime_{{vars['audit_info']['cyops_playbook_iri'].split('/')[-1].replace('-','_')}}"
                },
                "triggerOnSource": true,
                "triggerOnReplicate": false
              },
              "status": null,
              "top": "40",
              "left": "40",
              "stepType": "/api/3/workflow_step_types/b348f017-9a94-471f-87f8-ce88b6a7ad62",
              "group": null,
              "uuid": "5f28cfd0-c7c1-4e78-91af-1560c60df4fb"
            }
          ],
          "routes": [
            {
              "@type": "WorkflowRoute",
              "name": "Configuration -> Get Macro Value",
              "targetStep": "/api/3/workflow_steps/64485e00-9584-4ac1-a526-d2d210bc461b",
              "sourceStep": "/api/3/workflow_steps/ae4e9e41-33be-402f-a263-76df47ac43d4",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "f3b53662-f2a4-4fe0-82b1-0063eece17f4"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Create Feed List -> Create Record",
              "targetStep": "/api/3/workflow_steps/5e57c359-8b3d-4afd-959d-d1d8e35949d7",
              "sourceStep": "/api/3/workflow_steps/af3335d3-da17-47ea-ba46-be4437bc4bb2",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "5690acbc-b8a4-4f14-b194-57b1cdacc9c2"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Create Record2 -> Save Result",
              "targetStep": "/api/3/workflow_steps/3182873d-b317-48b1-bf4c-5faca1f0b94c",
              "sourceStep": "/api/3/workflow_steps/5e57c359-8b3d-4afd-959d-d1d8e35949d7",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "094e2277-b2bb-486c-9fa6-456baac45e52"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Fetch Indicators -> Create Feed List",
              "targetStep": "/api/3/workflow_steps/af3335d3-da17-47ea-ba46-be4437bc4bb2",
              "sourceStep": "/api/3/workflow_steps/6610fe3c-4053-424b-82a6-18165de6d572",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "22569428-04ee-4978-b6d5-1ccb31925eaa"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Fetch Indicators Limited -> Create Feed List",
              "targetStep": "/api/3/workflow_steps/af3335d3-da17-47ea-ba46-be4437bc4bb2",
              "sourceStep": "/api/3/workflow_steps/e7941217-07de-4066-8889-f795e2ba6d82",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "bf73acbe-9ece-4fc5-8354-7cf3de248959"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Fetch Sample Indicators -> Fetch Data",
              "targetStep": "/api/3/workflow_steps/af331221-8d2b-4278-9708-ea72b9707f56",
              "sourceStep": "/api/3/workflow_steps/0f516390-3ec6-470d-8ac0-8eb87e92908a",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "03f72f2b-ee42-4f05-8c5f-d188b6eed4d6"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Get Macro Value -> Resolve Range",
              "targetStep": "/api/3/workflow_steps/33d4aa0e-aef1-43f9-bb9f-4f691e04c19f",
              "sourceStep": "/api/3/workflow_steps/64485e00-9584-4ac1-a526-d2d210bc461b",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "51f8ee76-7ff3-441f-a257-b3987f1afbb8"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Is data only for mapping -> Copy of Fetch Indicators",
              "targetStep": "/api/3/workflow_steps/0f516390-3ec6-470d-8ac0-8eb87e92908a",
              "sourceStep": "/api/3/workflow_steps/e80a51bd-ee90-4cd1-a228-f25dfe23d173",
              "label": "Yes, For Mapping",
              "isExecuted": false,
              "group": null,
              "uuid": "76ce6f1b-e6a3-4050-b07f-58d37e8a11bc"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Is data only for mapping -> Number of Records to Fetch",
              "targetStep": "/api/3/workflow_steps/0423c84d-3ef2-4ba7-bb11-ec376117de20",
              "sourceStep": "/api/3/workflow_steps/e80a51bd-ee90-4cd1-a228-f25dfe23d173",
              "label": "No, For Ingestion",
              "isExecuted": false,
              "group": null,
              "uuid": "fea22410-733a-4196-97f1-bc2d61dd8e0a"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Make Query -> Is data only for mapping",
              "targetStep": "/api/3/workflow_steps/e80a51bd-ee90-4cd1-a228-f25dfe23d173",
              "sourceStep": "/api/3/workflow_steps/94858ce4-6446-40a5-b706-f13ad3e068f5",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "c6ae7e44-9b28-4703-909d-b18f5b90eaa2"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Number of Records to Fetch -> F",
              "targetStep": "/api/3/workflow_steps/e7941217-07de-4066-8889-f795e2ba6d82",
              "sourceStep": "/api/3/workflow_steps/0423c84d-3ef2-4ba7-bb11-ec376117de20",
              "label": "Fetch Limited Records",
              "isExecuted": false,
              "group": null,
              "uuid": "1a007a20-dae8-4bef-831c-8ded00593082"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Number of Records to Fetch -> Fetch Indicators",
              "targetStep": "/api/3/workflow_steps/6610fe3c-4053-424b-82a6-18165de6d572",
              "sourceStep": "/api/3/workflow_steps/0423c84d-3ef2-4ba7-bb11-ec376117de20",
              "label": "Fetch All Records",
              "isExecuted": false,
              "group": null,
              "uuid": "d3682406-35be-479f-9668-9cf262d0305c"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Resolve Range -> Make Query",
              "targetStep": "/api/3/workflow_steps/94858ce4-6446-40a5-b706-f13ad3e068f5",
              "sourceStep": "/api/3/workflow_steps/33d4aa0e-aef1-43f9-bb9f-4f691e04c19f",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "5a0ad683-fe5b-4b20-a6a4-c79084fbe972"
            },
            {
              "@type": "WorkflowRoute",
              "name": "Start -> Configuration",
              "targetStep": "/api/3/workflow_steps/ae4e9e41-33be-402f-a263-76df47ac43d4",
              "sourceStep": "/api/3/workflow_steps/5f28cfd0-c7c1-4e78-91af-1560c60df4fb",
              "label": null,
              "isExecuted": false,
              "group": null,
              "uuid": "96535329-fdbf-4fa4-ae77-6c7a68d75d6a"
            }
          ],
          "groups": [],
          "priority": "/api/3/picklists/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
          "uuid": "f2311268-b3f1-449a-a62d-a661175b5477",
          "id": 575,
          "owners": [],
          "isPrivate": false,
          "deletedAt": null,
          "importedBy": [],
          "recordTags": [
            "create",
            "Cyware",
            "cyware-ctix-feed",
            "dataingestion",
            "fetch"
          ]
        }
      ]
    }
  ],
  "exported_tags": [
    "Cyware",
    "cyware-ctix-feed",
    "dataingestion",
    "ingest",
    "create",
    "fetch"
  ]
}